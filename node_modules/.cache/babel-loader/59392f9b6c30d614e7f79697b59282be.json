{"ast":null,"code":"import _slicedToArray from \"/Users/jacabe/Downloads/03-taginput-answer/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\n\nvar _jsxFileName = \"/Users/jacabe/Downloads/03-taginput-answer/src/components/TagInput.jsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React, { useState, useCallback, useEffect, useRef, useLayoutEffect } from \"react\";\nimport Tag from \"./Tag\";\nimport style from \"./TagInput.module.scss\";\nimport gsap from \"gsap\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar TagInput = function TagInput(props) {\n  _s();\n\n  var tags = props.tags,\n      onChange = props.onChange,\n      disabled = props.disabled;\n\n  var _useState = useState(\"\"),\n      _useState2 = _slicedToArray(_useState, 2),\n      input = _useState2[0],\n      setInput = _useState2[1];\n\n  var tagsRef = useRef(); // Record<string, HtmlElement>;\n\n  tagsRef.current = {};\n\n  var atInputKeyDown = function atInputKeyDown(e) {\n    if (e.keyCode !== 13 || input === \"\") {\n      //不是按enter和沒輸入東西時\n      return;\n    }\n\n    setInput(\"\");\n\n    if (tags.includes(input)) {\n      //重複的時候\n      var findDOM = tagsRef.current[input];\n      gsap.to(findDOM, {\n        scale: 1.2,\n        yoyo: true,\n        repeat: 1,\n        duration: 0.15\n      });\n      return;\n    }\n\n    onChange(tags.concat(input)); //執行\n  };\n\n  var atTagRemove = useCallback( //刪除功能\n  function (text) {\n    onChange(tags.filter(function (t) {\n      return t !== text;\n    }));\n  }, [onChange, tags]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: style.root,\n    \"data-active\": !disabled,\n    children: [tags.map(function (text, i) {\n      //跑出先前的tag\n      return /*#__PURE__*/_jsxDEV(Tag, {\n        onRemove: atTagRemove,\n        currentInput: input,\n        text: text,\n        ref: function ref(dom) {\n          tagsRef.current[text] = dom;\n        }\n      }, text, false, {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 11\n      }, _this);\n    }), /*#__PURE__*/_jsxDEV(\"input\", {\n      //輸入功能\n      \"data-testid\": \"taginput__input\",\n      className: style.input,\n      onKeyDown: atInputKeyDown,\n      value: input,\n      readOnly: disabled,\n      onChange: function onChange(e) {\n        return setInput(e.target.value);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 50,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(TagInput, \"8apkB6HxzJla84I04JcujUC52NY=\");\n\n_c = TagInput;\nexport default TagInput;\n\nvar _c;\n\n$RefreshReg$(_c, \"TagInput\");","map":{"version":3,"names":["React","useState","useCallback","useEffect","useRef","useLayoutEffect","Tag","style","gsap","TagInput","props","tags","onChange","disabled","input","setInput","tagsRef","current","atInputKeyDown","e","keyCode","includes","findDOM","to","scale","yoyo","repeat","duration","concat","atTagRemove","text","filter","t","root","map","i","dom","target","value"],"sources":["/Users/jacabe/Downloads/03-taginput-answer/src/components/TagInput.jsx"],"sourcesContent":["import React, {\r\n  useState,\r\n  useCallback,\r\n  useEffect,\r\n  useRef,\r\n  useLayoutEffect\r\n} from \"react\";\r\nimport Tag from \"./Tag\";\r\nimport style from \"./TagInput.module.scss\";\r\nimport gsap from \"gsap\";\r\ntype TagInputProps = {\r\n  tags: string[],\r\n  onChange?: (tags: string[]) => void,\r\n  disabled: boolean\r\n};\r\n\r\nconst TagInput: React.FC<TagInputProps> = (props) => {\r\n  const { tags, onChange, disabled } = props;\r\n\r\n  const [input, setInput] = useState(\"\");\r\n  const tagsRef = useRef(); // Record<string, HtmlElement>;\r\n  tagsRef.current = {};\r\n\r\n  const atInputKeyDown = (e) => {\r\n    if (e.keyCode !== 13 || input === \"\") { //不是按enter和沒輸入東西時\r\n      return;\r\n    }\r\n    setInput(\"\");\r\n    if (tags.includes(input)) { //重複的時候\r\n      const findDOM = tagsRef.current[input];\r\n      gsap.to(findDOM, {\r\n        scale: 1.2,\r\n        yoyo: true,\r\n        repeat: 1,\r\n        duration: 0.15\r\n      });\r\n      return;\r\n    }\r\n    onChange(tags.concat(input)); //執行\r\n  };\r\n\r\n  const atTagRemove = useCallback( //刪除功能\r\n    (text) => {\r\n      onChange(tags.filter((t) => t !== text));\r\n    },\r\n    [onChange, tags]\r\n  );\r\n\r\n  return (\r\n    <div className={style.root} data-active={!disabled}>\r\n      {tags.map((text, i) => { //跑出先前的tag\r\n        return (\r\n          <Tag\r\n            onRemove={atTagRemove}\r\n            currentInput={input}\r\n            text={text}\r\n            key={text}\r\n            ref={(dom) => {\r\n              tagsRef.current[text] = dom;\r\n            }}\r\n          />\r\n        );\r\n      })}\r\n      <input //輸入功能\r\n        data-testid=\"taginput__input\"\r\n        className={style.input}\r\n        onKeyDown={atInputKeyDown}\r\n        value={input}\r\n        readOnly={disabled}\r\n        onChange={(e) => setInput(e.target.value)}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TagInput;\r\n"],"mappings":";;;;;;AAAA,OAAOA,KAAP,IACEC,QADF,EAEEC,WAFF,EAGEC,SAHF,EAIEC,MAJF,EAKEC,eALF,QAMO,OANP;AAOA,OAAOC,GAAP,MAAgB,OAAhB;AACA,OAAOC,KAAP,MAAkB,wBAAlB;AACA,OAAOC,IAAP,MAAiB,MAAjB;;;AAOA,IAAMC,QAAiC,GAAG,SAApCA,QAAoC,CAACC,KAAD,EAAW;EAAA;;EACnD,IAAQC,IAAR,GAAqCD,KAArC,CAAQC,IAAR;EAAA,IAAcC,QAAd,GAAqCF,KAArC,CAAcE,QAAd;EAAA,IAAwBC,QAAxB,GAAqCH,KAArC,CAAwBG,QAAxB;;EAEA,gBAA0BZ,QAAQ,CAAC,EAAD,CAAlC;EAAA;EAAA,IAAOa,KAAP;EAAA,IAAcC,QAAd;;EACA,IAAMC,OAAO,GAAGZ,MAAM,EAAtB,CAJmD,CAIzB;;EAC1BY,OAAO,CAACC,OAAR,GAAkB,EAAlB;;EAEA,IAAMC,cAAc,GAAG,SAAjBA,cAAiB,CAACC,CAAD,EAAO;IAC5B,IAAIA,CAAC,CAACC,OAAF,KAAc,EAAd,IAAoBN,KAAK,KAAK,EAAlC,EAAsC;MAAE;MACtC;IACD;;IACDC,QAAQ,CAAC,EAAD,CAAR;;IACA,IAAIJ,IAAI,CAACU,QAAL,CAAcP,KAAd,CAAJ,EAA0B;MAAE;MAC1B,IAAMQ,OAAO,GAAGN,OAAO,CAACC,OAAR,CAAgBH,KAAhB,CAAhB;MACAN,IAAI,CAACe,EAAL,CAAQD,OAAR,EAAiB;QACfE,KAAK,EAAE,GADQ;QAEfC,IAAI,EAAE,IAFS;QAGfC,MAAM,EAAE,CAHO;QAIfC,QAAQ,EAAE;MAJK,CAAjB;MAMA;IACD;;IACDf,QAAQ,CAACD,IAAI,CAACiB,MAAL,CAAYd,KAAZ,CAAD,CAAR,CAf4B,CAeE;EAC/B,CAhBD;;EAkBA,IAAMe,WAAW,GAAG3B,WAAW,EAAE;EAC/B,UAAC4B,IAAD,EAAU;IACRlB,QAAQ,CAACD,IAAI,CAACoB,MAAL,CAAY,UAACC,CAAD;MAAA,OAAOA,CAAC,KAAKF,IAAb;IAAA,CAAZ,CAAD,CAAR;EACD,CAH4B,EAI7B,CAAClB,QAAD,EAAWD,IAAX,CAJ6B,CAA/B;EAOA,oBACE;IAAK,SAAS,EAAEJ,KAAK,CAAC0B,IAAtB;IAA4B,eAAa,CAACpB,QAA1C;IAAA,WACGF,IAAI,CAACuB,GAAL,CAAS,UAACJ,IAAD,EAAOK,CAAP,EAAa;MAAE;MACvB,oBACE,QAAC,GAAD;QACE,QAAQ,EAAEN,WADZ;QAEE,YAAY,EAAEf,KAFhB;QAGE,IAAI,EAAEgB,IAHR;QAKE,GAAG,EAAE,aAACM,GAAD,EAAS;UACZpB,OAAO,CAACC,OAAR,CAAgBa,IAAhB,IAAwBM,GAAxB;QACD;MAPH,GAION,IAJP;QAAA;QAAA;QAAA;MAAA,SADF;IAWD,CAZA,CADH,eAcE;MAAO;MACL,eAAY,iBADd;MAEE,SAAS,EAAEvB,KAAK,CAACO,KAFnB;MAGE,SAAS,EAAEI,cAHb;MAIE,KAAK,EAAEJ,KAJT;MAKE,QAAQ,EAAED,QALZ;MAME,QAAQ,EAAE,kBAACM,CAAD;QAAA,OAAOJ,QAAQ,CAACI,CAAC,CAACkB,MAAF,CAASC,KAAV,CAAf;MAAA;IANZ;MAAA;MAAA;MAAA;IAAA,SAdF;EAAA;IAAA;IAAA;IAAA;EAAA,SADF;AAyBD,CAzDD;;GAAM7B,Q;;KAAAA,Q;AA2DN,eAAeA,QAAf"},"metadata":{},"sourceType":"module"}